_G["ESX"],_G["xPlayer"],_G["source"],_G["developer"]=nil,{},GetPlayerServerId(PlayerId()),function()end;local a,b,c,d,e,f,g,h,i,j,k,l,m,o,p,q,r,s,t=AddTextEntry,BeginTextCommandDisplayHelp,EndTextCommandDisplayHelp,SetNotificationTextEntry,AddTextComponentSubstringPlayerName,DrawNotification,GetEntityCoords,World3dToScreen2d,SetTextScale,SetTextFont,SetTextEntry,SetTextCentre,AddTextComponentString,DrawText,DoesEntityExist,GetDistanceBetweenCoords,GetPlayerPed,TriggerEvent,TriggerServerEvent;local u=GetCurrentResourceName()local v={["ESC"]=322,["F1"]=288,["F2"]=289,["F3"]=170,["F5"]=166,["F6"]=167,["F7"]=168,["F8"]=169,["F9"]=56,["F10"]=57,["~"]=243,["1"]=157,["2"]=158,["3"]=160,["4"]=164,["5"]=165,["6"]=159,["7"]=161,["8"]=162,["9"]=163,["-"]=84,["="]=83,["BACKSPACE"]=177,["TAB"]=37,["Q"]=44,["W"]=32,["E"]=38,["R"]=45,["T"]=245,["Y"]=246,["U"]=303,["P"]=199,["["]=39,["]"]=40,["ENTER"]=18,["CAPS"]=137,["A"]=34,["S"]=8,["D"]=9,["F"]=23,["G"]=47,["H"]=74,["K"]=311,["L"]=182,["LEFTSHIFT"]=21,["Z"]=20,["X"]=73,["C"]=26,["V"]=0,["B"]=29,["N"]=249,["M"]=244,[","]=82,["."]=81,["LEFTCTRL"]=36,["LEFTALT"]=19,["SPACE"]=22,["RIGHTCTRL"]=70,["HOME"]=213,["PAGEUP"]=10,["PAGEDOWN"]=11,["DELETE"]=178,["LEFT"]=174,["RIGHT"]=175,["TOP"]=27,["DOWN"]=173,["NENTER"]=201,["N4"]=108,["N5"]=60,["N6"]=107,["N+"]=96,["N-"]=97,["N7"]=117,["N8"]=61,["N9"]=118}UtilityLibLoaded=true;local w={Cache={PlayerPedId=PlayerPedId(),Marker={},Object={},Dialogue={},Blips={},N3d={},Events={},SetData={},Frozen={},FlowDetector={},Constant={},Settings={},EntityStack={},Loop={},SliceGroups={}}}if u=="utility_lib"then _G["Utility"]=w end;UseDelete=function(x)w.Cache.Settings.UseDelete=x end;On=function(type,y,z)RegisterNetEvent("Utility:On:"..(z and"!"or"")..type)local A=AddEventHandler("Utility:On:"..(z and"!"or"")..type,y)table.insert(w.Cache.Events,A)end;_G.old_TaskVehicleDriveToCoord=TaskVehicleDriveToCoord;TaskVehicleDriveToCoord=function(B,C,D,E,F)old_TaskVehicleDriveToCoord(B,C,D,E or 10.0,0,GetEntityModel(C),2883621,F or 1.0)end;_G.old_DisableControlAction=DisableControlAction;DisableControlAction=function(G,H)return old_DisableControlAction(0,v[string.upper(G)],true or H)end;DisableControlForSeconds=function(G,I)local J=I;Citizen.CreateThread(function()while J>0 do Citizen.Wait(1000)J=J-1 end;return end)Citizen.CreateThread(function()while J>0 do DisableControlAction(v[string.upper(G)])Citizen.Wait(1)end;return end)end;_G.old_IsControlJustPressed=IsControlJustPressed;IsControlJustPressed=function(K,L)developer("^2Created^0","key map",K)RegisterKeyMapping('utility '..u..' '..K,'',"keyboard",K)table.insert(w.Cache.Events,AddEventHandler("Utility:Pressed_"..u.."_"..K,L))end;ShowNotification=function(M)d('STRING')e(M)f(false,true)end;ButtonNotification=function(M)if string.match(M,"{.*}")then M=string.multigsub(M,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_LR~","~INPUT_CONTEXT~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})end;a('ButtonNotification',M)b('ButtonNotification')c(0,false,true,-1)end;ButtonFor=function(M,N)local O=GetGameTimer()Citizen.CreateThread(function()while GetGameTimer()-O<(N or 5000)do ButtonNotification(M)Citizen.Wait(1)end end)end;FloatingNotification=function(M,P)a('FloatingNotification',M)SetFloatingHelpTextWorldPosition(1,P)SetFloatingHelpTextStyle(1,1,2,-1,3,0)b('FloatingNotification')c(2,false,false,-1)end;MakeEntityFaceEntity=function(Q,R,S)local T=g(Q,true)local U=g(R,true)if S then local V=GetHeadingFromVector_2d(U.x-T.x,U.y-T.y)SetEntityHeading(Q,V)else local V=GetHeadingFromVector_2d(T.x-U.x,T.y-U.y)SetEntityHeading(R,V)end end;DrawText3Ds=function(P,W,X,Y,Z)if P then local _,a0,a1=h(P.x,P.y,P.z)if _ then i(X or 0.35,X or 0.35)j(Y or 4)k("STRING")l(1)m(W)o(a0,a1)if Z then local a2=string.len(W)/370;local a3,a4=string.gsub(a2,"\n","\n")*0.025;if a4==nil then a4=0 end;DrawRect(a0,a1+0.0125,0.025+a2,0.025+a4,0,0,0,90)end end end end;_G.old_TaskPlayAnim=TaskPlayAnim;TaskPlayAnim=function(B,a5,...)if not HasAnimDictLoaded(a5)then RequestAnimDict(a5)while not HasAnimDictLoaded(a5)do Citizen.Wait(1)end end;old_TaskPlayAnim(B,a5,...)RemoveAnimDict(a5)end;TaskEasyPlayAnim=function(a6,a7,a8,a9)if a8==nil then a8=51 end;if a9==nil then a9=-1 end;TaskPlayAnim(PlayerPedId(),a6,a7,2.0,2.0,a9,a8,0)if a9>-1 or a9>0 then Citizen.Wait(a9)end end;_G.old_CreateObject=CreateObject;CreateObject=function(aa,...)if type(aa)=="string"then aa=GetHashKey(aa)end;if not HasModelLoaded(aa)then RequestModel(aa)while not HasModelLoaded(aa)do Citizen.Wait(1)end end;local ab=old_CreateObject(aa,...)if w.Cache.Settings.UseDelete then table.insert(w.Cache.EntityStack,ab)end;SetModelAsNoLongerNeeded(aa)local ac=0;if NetworkGetEntityIsNetworked(ab)then ac=ObjToNet(ab)SetNetworkIdExistsOnAllMachines(ac,true)SetNetworkIdCanMigrate(ac,true)end;return ab,ac end;_G.old_CreatePed=CreatePed;CreatePed=function(aa,...)if type(aa)=="string"then aa=GetHashKey(aa)end;if not HasModelLoaded(aa)then RequestModel(aa)while not HasModelLoaded(aa)do Citizen.Wait(1)end end;local B=old_CreatePed(0,aa,...)SetModelAsNoLongerNeeded(aa)local ac=0;if NetworkGetEntityIsNetworked(B)then ac=PedToNet(B)SetNetworkIdExistsOnAllMachines(ac,true)SetNetworkIdCanMigrate(ac,true)end;return B,ac end;SetPedStatic=function(ad,ae)FreezeEntityPosition(ad,ae)SetEntityInvincible(ad,ae)SetBlockingOfNonTemporaryEvents(ad,ae)end;_G.old_CreateVehicle=CreateVehicle;CreateVehicle=function(aa,...)if type(aa)=="string"then aa=GetHashKey(aa)end;if not HasModelLoaded(aa)then RequestModel(aa)while not HasModelLoaded(aa)do Citizen.Wait(1)end end;local af=old_CreateVehicle(aa,...)SetModelAsNoLongerNeeded(aa)local ac=0;if NetworkGetEntityIsNetworked(af)then ac=VehToNet(af)SetNetworkIdExistsOnAllMachines(ac,true)SetNetworkIdCanMigrate(ac,true)end;return af,ac end;_G.old_DeleteEntity=DeleteEntity;DeleteEntity=function(ad,ag)if not ag then NetworkRequestControlOfEntity(ad)while not NetworkRequestControlOfEntity(ad)do Citizen.Wait(1)end;if not IsEntityAMissionEntity(ad)then SetEntityAsMissionEntity(ad)end;old_DeleteEntity(ad)else NetworkRequestControlOfNetworkId(ad)local ah=NetworkGetEntityFromNetworkId(ad)while not NetworkRequestControlOfEntity(ah)do Citizen.Wait(1)end;SetEntityAsMissionEntity(ah)old_DeleteEntity(ah)end end;_G.old_RegisterNetEvent=RegisterNetEvent;RegisterNetEvent=function(ai,aj)old_RegisterNetEvent(ai)AddEventHandler(ai,aj)end;_G.old_GetPlayerName=GetPlayerName;GetPlayerName=function(ak)return old_GetPlayerName(ak or PlayerId())end;_G.old_PlayerPedId=PlayerPedId;PlayerPedId=function()if not p(w.Cache.PlayerPedId)then w.Cache.PlayerPedId=old_PlayerPedId()end;return w.Cache.PlayerPedId end;StopLoop=function(ak)w.Cache.Loop[ak].status=false end;CreateLoop=function(L,al,am)local an=RandomId(5)w.Cache.Loop[an]={status=true,func=L,tick=al}if am~=false then Citizen.CreateThread(function()while w.Cache.Loop[an]and w.Cache.Loop[an].status do L(an)Citizen.Wait(al or 1)end end)end;return an end;PauseLoop=function(an,ao)Citizen.SetTimeout(ao or 0,function()print("Pausing loop "..an)w.Cache.Loop[an].status=false end)end;ResumeLoop=function(an,ao)local ap=w.Cache.Loop[an]Citizen.SetTimeout(ao or 0,function()print("Resuming loop "..an)ap.status=true;Citizen.CreateThread(function()while ap and ap.status do ap.func(an)Citizen.Wait(ap.tick or 1)end end)end)end;GetWorldClosestPed=function(aq)local ar=0;local as=GetGamePool("CPed")local P=g(PlayerPedId())local at=aq+5.0;for au=1,#as do local av=q(P,g(as[au]),false)if av<=aq and as[au]~=PlayerPedId()then if at>av then at=av;ar=as[au]end end end;return ar,as end;GetWorldClosestPlayer=function(aq)local ar=0;local aw={}local at=aq+5.0;local as=GetGamePool("CPed")local P=g(PlayerPedId())for au=1,#as do if IsPedAPlayer(as[au])then table.insert(aw,NetworkGetPlayerIndexFromPed(as[au]))local av=q(P,g(as[au]),false)if av<=aq and as[au]~=PlayerPedId()then if at>av then at=av;ar=NetworkGetPlayerIndexFromPed(as[au])end end end end;return ar,aw end;GetEntitySurfaceMaterial=function(ad)local P=GetEntityCoords(ad)local ax=StartShapeTestCapsule(P.x,P.y,P.z,P.x,P.y,P.z-2.5,2,1,ad,7)local a3,ay,a3,a3,az=GetShapeTestResultIncludingMaterial(ax)return az,ay end;GetLoadoutOfPed=function(B)local aA=ESX.GetWeaponList()local aB={}for au=1,#aA,1 do local hash=GetHashKey(aA.name)if HasPedGotWeapon(B,hash,false)then table.insert(aB,{name=aA.name,hash=hash,ammo=GetAmmoInPedWeapon(B,hash)})end end;return aB end;local aC=FreezeEntityPosition;FreezeEntityPosition=function(ad,ae)w.Cache.Frozen[ad]=ae;aC(ad,ae)end;IsEntityFrozen=function(ad)return w.Cache.Frozen[ad]==true end;GetNearestValue=function(aD,aE)local aF=100*100000000000;local aG=0;for au=1,#aE do local aH=math.abs(aE[au]-aD)if aH<aF then aF=aH;n=aE[au]aG=au end end;return n,aF,aG end;TriggerSyncedEvent=function(A,aI,...)if type(aI)=="number"or type(aI)=="table"then if aI==-1 then t("Utility:SyncEvent",A,"",...)else t("Utility:SyncEvent",A,aI,...)end else developer("^1Error^0","you can use only number/table on whitelist of TriggerSyncedEvent","")end end;StartESX=function(ai,aJ)Citizen.CreateThreadNow(function()ESX = exports["es_extended"]:getSharedObject();while ESX.GetPlayerData().job==nil do Citizen.Wait(1)end;xPlayer=ESX.GetPlayerData()if aJ~=nil then while ESX.GetPlayerData()[aJ]==nil do Citizen.Wait(1)end;xPlayer=ESX.GetPlayerData()end;if aJ~=nil then RegisterNetEvent('esx:set'..string.upper(aJ:sub(1,1))..aJ:sub(2),function(aK)xPlayer[aJ]=aK end)end;RegisterNetEvent('esx:setJob',function(aK)xPlayer.job=aK end)end)end;StartQB=function(aL)QBCore=exports['qb-core']:GetCoreObject()end;GetDataForJob=function(aK)local aM=promise:new()if GetResourceState("es_extended")=="started"then ESX.TriggerServerCallback("Utility:GetJobData",function(aN)aM:resolve(aN)end,aK)elseif GetResourceState("qb-core")=="started"then QBCore.Functions.TriggerCallback("Utility:GetJobData",function(aN)aM:resolve(aN)end,aK)end;aM=Citizen.Await(aM)return#aM,aM end;local aO=0;GetOnHandObject=function()return aO end;TakeObjectOnHand=function(B,aP,aQ,aR,aS,aT,aU,aV,aW)developer("^2Taking^0","object",aP.." ("..GetEntityModel(aP)..")")if type(aP)=="number"then TaskPlayAnim(B,"anim@heists@box_carry@","idle",3.0,3.0,-1,63,0,0,0,0)Citizen.Wait(100)AttachEntityToEntity(aP,B,GetPedBoneIndex(B,60309),aR or 0.2,aS or 0.08,aT or 0.2,aU or-45.0,aV or 290.0,aW or 0.0,true,true,false,true,1,true)aO=aP elseif type(aP)=="string"then local P=g(B)local aX=CreateObject(aP,P+vector3(0.0,0.0,aQ or 0.2),true,false,false)SetEntityAsMissionEntity(aX)TaskPlayAnim(B,"anim@heists@box_carry@","idle",3.0,-8,-1,63,0,0,0,0)Citizen.Wait(100)AttachEntityToEntity(aX,B,GetPedBoneIndex(B,60309),aR or 0.2,aS or 0.08,aT or 0.2,aU or-45.0,aV or 290.0,aW or 0.0,true,true,false,true,1,true)aO=aX;return aX end end;DropObjectFromHand=function(aY,aZ)if aZ then developer("^1Deleting^0","from hand",aY)DeleteEntity(aY)else developer("^3Dont delete^0","from hand",aY)DetachEntity(aY)SetEntityCoords(aY,GetOffsetFromEntityInWorldCoords(aY,0,0.5,0))PlaceObjectOnGroundProperly(aY)FreezeEntityPosition(aY,true)end;ClearPedTasks(PlayerPedId())aO=0 end;IsInRadius=function(T,U,aq,a_)local av=#(T-U)if a_ then DrawSphere(U,aq,255,0,0,0.5)end;return av<aq end;IsNearCoords=function(P,aq,a_)local av=#(GetEntityCoords(PlayerPedId())-P)if a_ then DrawSphere(P,aq,255,0,0,0.5)end;return av<aq end;GenerateRandomCoords=function(P,aq,V)local b0=P.x+math.random(-aq,aq)local b1=P.y+math.random(-aq,aq)local a3,b2=GetGroundZFor_3dCoord(b0,b1,200.0,0)if V then return vector3(b0,b1,b2),math.random(0.0,360.0)end;return vector3(b0,b1,b2)end;SetFor=function(ak,b3,b4)if w.Cache["SetData"][ak]==nil then w.Cache["SetData"][ak]={}end;if type(b3)=="table"then for b5,aD in pairs(b3)do developer("^2Setting^0","data","("..ak..") ["..b5 .." = "..json.encode(aD).."] {table}")w.Cache["SetData"][ak][b5]=aD end else developer("^2Setting^0","data","("..ak..") ["..b3 .." = "..json.encode(b4).."] {single}")w.Cache["SetData"][ak][b3]=b4 end end;GetFrom=function(ak,b3)if b3==nil then b3="not defined"end;developer("^3Getting^0","data","("..ak..") ["..b3 .."]")if w.Cache["SetData"][ak]~=nil then if b3=="not defined"then return w.Cache["SetData"][ak]else return w.Cache["SetData"][ak][b3]end else return nil end end;function GetSliceCoordsFromCoords(b6)return vector2(math.floor((b6.x+8192)/100),math.floor((b6.y+8192)/100))end;function GetSliceFromCoords(b7)local b8=GetSliceCoordsFromCoords(b7)local ak=b8.x*math.pow(2,2)+b8.y;return ak end;function GetEntitySlice(B)return GetSliceFromCoords(GetEntityCoords(B))end;function GetPlayerSlice(b9)local B=GetPlayerPed(b9)return GetSliceFromCoords(GetEntityCoords(B))end;function GetSelfSlice()local B=PlayerPedId()return GetSliceFromCoords(GetEntityCoords(B))end;function IsOnScreen(P)local _,a0,a1=World3dToScreen2d(P.x,P.y,P.z)return _ end;function SliceUsed(b8)return w.Cache.SliceGroups[b8]or false end;function SetSliceUsed(b8,b4)w.Cache.SliceGroups[b8]=b4 end;RandomId=function(ba)ba=ba or 5;local bb=""for au=1,ba do bb=bb.."9"end;return math.random(0,bb)end;CreateMarker=function(ak,P,bc,bd,be)if DoesExist("m",ak)then Citizen.Wait(100)return else if type(P)~="vector3"then developer("^1Error^0","You can use only vector3 for coords!",ak)return end;ak=string.gsub(ak,"{r}",RandomId())developer("^2Created^0","Marker",ak)local bf={render_distance=bc,interaction_distance=bd,coords=P,slice=be.slice=="ignore"and-1 or tostring(GetSliceFromCoords(P))}if type(be)=="table"then if be.rgb~=nil then bf.type=1;bf.rgb=be.rgb elseif be.text~=nil then bf.type=0;bf.text=be.text else bf.type=1;bf.rgb={be[1],be[2],be[3]}end;if be.type~=nil and type(be.type)=="number"then bf._type=be.type end;if be.direction~=nil and type(be.direction)=="vector3"then bf._direction=be.direction end;if be.rotation~=nil and type(be.rotation)=="vector3"then bf._rot=be.rotation end;if be.scale~=nil and type(be.scale)=="vector3"then bf._scale=be.scale end;if be.alpha~=nil and type(be.alpha)=="number"then bf.alpha=be.alpha end;if be.animation~=nil and type(be.animation)=="boolean"then bf.anim=be.animation end;if be.job~=nil then bf.job=be.job end;if be.notify~=nil then local bg=string.multigsub(be.notify,{"{A}","{B}","{C}","{D}","{E}","{F}","{G}","{H}","{L}","{M}","{N}","{O}","{P}","{Q}","{R}","{S}","{T}","{U}","{V}","{W}","{X}","{Y}","{Z}"},{"~INPUT_VEH_FLY_YAW_LEFT~","~INPUT_SPECIAL_ABILITY_SECONDARY~","~INPUT_LOOK_BEHIND~","~INPUT_MOVE_LR~","~INPUT_CONTEXT~","~INPUT_ARREST~","~INPUT_DETONATE~","~INPUT_VEH_ROOF~","~INPUT_CELLPHONE_CAMERA_FOCUS_LOCK~","~INPUT_INTERACTION_MENU~","~INPUT_REPLAY_ENDPOINT~","~INPUT_FRONTEND_PAUSE~","~INPUT_FRONTEND_LB~","~INPUT_RELOAD~","~INPUT_MOVE_DOWN_ONLY~","~INPUT_MP_TEXT_CHAT_ALL~","~INPUT_REPLAY_SCREENSHOT~","~INPUT_NEXT_CAMERA~","~INPUT_MOVE_UP_ONLY~","~INPUT_VEH_HOTWIRE_LEFT~","~INPUT_VEH_DUCK~","~INPUT_MP_TEXT_CHAT_TEAM~","~INPUT_HUD_SPECIAL~"})bf.notify=bg end elseif type(be)=="string"then bf.type=0;bf.text=be end;w.Cache.Marker[ak]=bf;s("Utility:Create","Marker",ak,bf)end end;SetMarker=function(ak,bh,K,b4)if type(b4)~=bh then developer("^1Error^0",K.." can be only a "..bh,"[Marker]")return end;if DoesExist("marker",ak)then w.Cache.Marker[ak][K]=b4;s("Utility:Edit","Marker",ak,K,b4)else developer("^1Error^0","Unable to edit the marker as it does not exist",ak)end end;SetMarkerType=function(ak,bh)SetMarker(ak,"number","_type",bh)end;SetMarkerDirection=function(ak,bi)SetMarker(ak,"vector3","_direction",bi)end;SetMarkerRotation=function(ak,bj)SetMarker(ak,"vector3","_rot",bj)end;SetMarkerScale=function(ak,X)SetMarker(ak,"vector3","_scale",X)end;SetMarkerColor=function(ak,bk)SetMarker(ak,"table","rgb",bk)end;SetMarkerCoords=function(ak,P)SetMarker(ak,"vector3","coords",P)end;SetMarkerRenderDistance=function(ak,bc)SetMarker(ak,"number","render_distance",bc)end;SetMarkerInteractionDistance=function(ak,bd)SetMarker(ak,"number","interaction_distance",bd)end;SetMarkerAlpha=function(ak,bl)SetMarker(ak,"number","alpha",bl)end;SetMarkerAnimation=function(ak,ae)SetMarker(ak,"boolean","anim",ae)end;SetMarkerDrawOnEntity=function(ak,ae)SetMarker(ak,"boolean","draw_entity",ae)end;Set3dText=function(ak,W)SetMarker(ak,"string","text",W)end;Set3dTextScale=function(ak,X)SetMarker(ak,"number","_scale",X)end;Set3dTextDrawRect=function(ak,ae)SetMarker(ak,"boolean","rect",ae)end;Set3dTextFont=function(ak,Y)SetMarker(ak,"number","font",Y)end;DeleteMarker=function(ak)if not DoesExist("m",ak)then Citizen.Wait(100)return else developer("^1Deleted^0","Marker",ak)w.Cache.Marker[ak]=nil;s("Utility:Remove","Marker",ak)end end;CreateiObject=function(ak,bm,b7,V,bd,bn,aK)developer("^2Created^0 Object "..ak.." ("..bm..")")local ab;if bn~=nil then ab=CreateObject(GetHashKey(bm),b7.x,b7.y,b7.z,bn,false,false)or nil else ab=CreateObject(GetHashKey(bm),b7.x,b7.y,b7.z,true,false,false)or nil end;SetEntityHeading(ab,V)SetEntityAsMissionEntity(ab,true,true)FreezeEntityPosition(ab,true)SetModelAsNoLongerNeeded(hash)_object={obj=ab,coords=b7,interaction_distance=bd or 3.0,slice=tostring(GetSliceFromCoords(b7)),job=aK}w.Cache.Object[ak]=_object;s("Utility:Create","Object",ak,_object)return ab,g(ab)end;DeleteiObject=function(ak,aZ)developer("^1Deleted^0","Object",ak)if aZ then DeleteEntity(w.Cache.Object[ak].obj)end;w.Cache.Object[ak]=nil;s("Utility:Remove","Object",ak)end;CreateBlip=function(bo,P,bp,bq,X)developer("^2Created^0","Blip",bo)local br=AddBlipForCoord(P)SetBlipSprite(br,bp)SetBlipScale(br,X or 1.0)SetBlipColour(br,bq)SetBlipAsShortRange(br,true)BeginTextCommandSetBlipName('STRING')e(bo)EndTextCommandSetBlipName(br)return br end;CreateJobBlip=function(bo,P,aK,bp,bq,X)s("Utility:Create","Blips",math.random(10000,99999),{name=bo,coords=P,job=aK,sprite=bp,colour=bq,scale=X or 1.0})end;SetIdOf=function(type,ak,bs)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ak)then w.Cache[type][bs]=w.Cache[type][ak]w.Cache[type][ak]=nil else developer("^1Error^0","Unable to set id of the "..type.." as it does not exist",ak)return end;developer("^3Change^0","Setted id to "..bs.." of the id",ak)s("Utility:Remove",type,ak)s("Utility:Create",type,bs,w.Cache[type][bs])end;GetDistanceFrom=function(type,ak)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;local av=0.0;if w.Cache[type][ak].coords~=nil then return q(g(PlayerPedId()),w.Cache[type][ak].coords,true)else return false end end;GetCoordOf=function(type,ak)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if DoesExist(type,ak)then return w.Cache[type][ak].coords else developer("^1Error^0","Unable to get the coords of the id",ak)return false end end;DoesExist=function(type,ak)if type:lower()=="marker"or type:lower()=="m"then type="Marker"elseif type:lower()=="object"or type:lower()=="o"then type="Object"else return nil end;if w.Cache[type][ak]~=nil then return true else return false end end;CreateCamera=function(P,bt,ae,bu)local bv=CreateCam("DEFAULT_SCRIPTED_CAMERA",true)SetCamCoord(bv,P)if bt~=nil then SetCamRot(bv,bt.x,bt.y,bt.z)end;if bu~=nil then ShakeCam(bv,bu.type or"",bu.amount or 0.0)end;if ae then SetCamActive(bv,true)RenderScriptCams(1,1,1500)end;return bv end;SwitchBetweenCam=function(bw,bv,a9)SetCamActiveWithInterp(bv,bw,a9 or 1500,1,1)Citizen.Wait(a9 or 1500)DestroyCam(bw)end;DevMode=function(bx,by,bz)if by==nil then by=true end;bz=bz or"%s %s %s"if bx then developer=function(bA,type,ak)local a3,a3,a3,bB,bC,bD=GetLocalTime()if by then if type==nil then print(bB..":"..bC..":"..bD.." - "..bA)else print(bB..":"..bC..":"..bD.." - "..string.format(bz,bA,type,ak))end else if type==nil then print(bA)else print(string.format(bz,bA,type,ak))end end end else developer=function()end end end;ReplaceTexture=function(aX,bE,bF,bG,bH)local bI=CreateRuntimeTxd('duiTxd')local bJ=CreateDui(bF,bG,bH)local bK=GetDuiHandle(bJ)local bL=CreateRuntimeTextureFromDuiHandle(bI,'duiTex',bK)AddReplaceTexture(aX,bE,'duiTxd','duiTex')end;printd=function(bM,bN)if bN then local bO={}local function bP(bQ,bR)if bO[tostring(bQ)]then print(bR.."*"..tostring(bQ))else bO[tostring(bQ)]=true;if type(bQ)=="table"then for b7,bS in pairs(bQ)do if type(bS)=="table"then print(bR.."["..b7 .."] => "..tostring(bQ).." {")bP(bS,bR..string.rep(" ",string.len(b7)+8))print(bR..string.rep(" ",string.len(b7)+6).."}")elseif type(bS)=="string"then print(bR.."["..b7 .."] => \""..bS.."\"")else print(bR.."["..b7 .."] => "..tostring(bS))end end else print(bR..tostring(bQ))end end end;if type(bM)=="table"then print(tostring(bM).." {")bP(bM,"  ")print("}")else developer("^1Error^0","error dumping table "..bM.." why isnt a table","")end else if type(bM)=="table"then print(json.encode(bM,{indent=true}))else developer("^1Error^0","error dumping table "..bM.." why isnt a table","")end end end;local bT=string.gsub;string.multigsub=function(string,table,bU)if type(table)then for au=1,#table do string=bT(string,table[au],bU[au])end else for au=1,#table do string=bT(string,table[au],bU)end end;return string end;table.fexist=function(bM,bV)bM=bM[bV]if not bM then return false else return true end end;local bW=table.remove;table.remove=function(bM,bX,bY)if type(bX)=="number"then bW(bM,bX)elseif type(bX)=="string"then for b5,aD in pairs(bM)do if b5==bX then bM[b5]=nil;if bY then break end end end end end;table.empty=function(bM)return next(bM)==nil end;table.clone=function(bM)bM.metatable={__index=bM}local bZ={}setmetatable(bZ,bM.metatable)return bZ end;local function b_(ad,_dialog,c0)return{Question=function(...)local c1={...}_dialog.questions=c1;return{Response=function(...)local c2={}local c3={}for c4,c5 in pairs({...})do c3[c4]={}for b5,aD in pairs(c5)do if c2[c4]==nil then c2[c4]=""end;c2[c4]=c2[c4]..b5 .."~w~ "..aD.." | "b5=string.multigsub(b5,{"%[","%]"},{"",""})b5=string.multigsub(b5,{"~r~","~b~","~g~","~y~","~p~","~o~","~c~","~m~","~u~","~n~","~s~","~w~"},{"","","","","","","","","","","",""})c3[c4][b5]=aD end;c2[c4]=c2[c4]:sub(1,-3)end;_dialog.response={no_formatted=c3,formatted=c2}if c0 then s("Utility:Remove","Dialogue",ad)s("Utility:Create","Dialogue",ad,_dialog)else s("Utility:Create","Dialogue",ad,_dialog)end;w.Cache.Dialogue[ad]=_dialog;return{LastQuestion=function(c6)w.Cache.Dialogue[ad].lastq=c6;s("Utility:Edit","Dialogue",ad,"lastq",c6)end}end}end}end;StartDialogue=function(ad,av,c7)local _dialog={}_dialog={entity=ad,distance=av,current_question=1,callback=c7,slice=tostring(GetEntitySlice(ad))}developer("^2Created^0","dialogue with entity",ad)return b_(ad,_dialog)end;EditDialogue=function(ad)if ad~=nil and IsEntityOnDialogue(ad)then return b_(ad,_dialog,true)end end;StopDialogue=function(ad)if ad~=nil and IsEntityOnDialogue(ad)then developer("^1Stopping^0","dialogue",ad)if w.Cache.Dialogue[ad].lastq~=nil then local c8=0;local c9=w.Cache.Dialogue[ad].lastq;local ca=w.Cache.Dialogue[ad].entity;local cb=GetEntityCoords(ca)+vector3(0.0,0.0,1.0)local cc=false;Citizen.SetTimeout(3000,function()cb=nil;cc=true end)CreateLoop(function(an)cb=GetEntityCoords(_entity)+vector3(0.0,0.0,1.0)if cc then cb=nil;StopLoop(an)end;DrawText3Ds(cb,c9,nil,nil,true)end)end;w.Cache.Dialogue[ad]=nil;s("Utility:Remove","Dialogue",ad)end end;RegisterNetEvent("Utility_Native:ResyncDialogue",function(ad)w.Cache.Dialogue[ad]=nil end)IsEntityOnDialogue=function(ad)return w.Cache.Dialogue[ad]end;local function cd(table)local ce={}print("Copying table "..tostring(table))for b5,aD in pairs(table)do ce[b5]=aD end;return ce end;CreateLoop(function()for bo,cf in pairs(w.Cache.FlowDetector)do local cg=_G[bo]if type(cg)=='table'or type(cf)=='table'then if json.encode(cf)~=json.encode(cg)then print("\nDetected old_value change of syncedV \""..bo.."\" from \""..json.encode(cf).."\" to \""..json.encode(cg).."\"")TriggerSyncedEvent("Utility:SyncValue_emit",-1,bo,cf,cg)TriggerSyncedEvent("Utility:SyncValue["..u.."]",-1,bo,cg)local ce=cd(cg)w.Cache.FlowDetector[bo]=ce end else if cg~=cf then TriggerSyncedEvent("Utility:SyncValue_emit",-1,bo,cf,cg)TriggerSyncedEvent("Utility:SyncValue["..u.."]",-1,bo,cg)w.Cache.FlowDetector[bo]=cg end end end end,2000)Synced=function(bo,b4)print("Creating synceV "..bo)if type(b4)=="table"then local ce=cd(b4)w.Cache.FlowDetector[bo]=ce;_G[bo]=b4 else w.Cache.FlowDetector[bo]=b4;_G[bo]=b4 end end;RegisterNetEvent("Utility:SyncValue["..u.."]",function(bo,b4)_G[bo]=b4 end)local function ch(ci,cj)local ck=RequestScaleformMovie(cj)local c8=100;while not HasScaleformMovieLoaded(ck)and c8>0 do c8=c8-1;ck=RequestScaleformMovie(cj)Citizen.Wait(5)end;if c8==0 then developer("^1Error^0","After 100 attempts to load the scaleform the scaleform has not loaded yet, try again or check that it has started correctly!","")return end;w.Cache.N3d[ci].scaleform=ck;s("Utility:Edit","N3d",ci,"scaleform",ck)end;local function cl(ci,bF,bG,bH)local bI=CreateRuntimeTxd('txd'..ci)w.Cache.N3d[ci].dui=CreateDui(bF,bG,bH)s("Utility:Edit","N3d",ci,"dui",w.Cache.N3d[ci].dui)local bK=GetDuiHandle(w.Cache.N3d[ci].dui)CreateRuntimeTextureFromDuiHandle(bI,'txn'..ci,bK)if w.Cache.N3d[ci].scaleform~=nil and not w.Cache.N3d[ci].txd then PushScaleformMovieFunction(w.Cache.N3d[ci].scaleform,'SET_TEXTURE')PushScaleformMovieMethodParameterString('txd'..ci)PushScaleformMovieMethodParameterString('txn'..ci)PushScaleformMovieFunctionParameterInt(0)PushScaleformMovieFunctionParameterInt(0)PushScaleformMovieFunctionParameterInt(bG)PushScaleformMovieFunctionParameterInt(bH)PopScaleformMovieFunctionVoid()w.Cache.N3d[ci].txd=true;s("Utility:Edit","N3d",ci,"txd",true)end end;function CreateNui3d(cm,bF)local ci=tostring(math.random(0,9999))local cn={txd=false,show=false,rotation={}}w.Cache.N3d[ci]=cn;s("Utility:Create","N3d",ci,cn)ch(ci,cm)if bF~=nil then print("Starting "..ci.." with url ".."nui://"..GetCurrentResourceName().."/"..bF.." sf "..cm)cl(ci,"nui://"..GetCurrentResourceName().."/"..bF,1920,1080)end;local co={}co.__index=co;co.init=function(self,bF,bG,bH)cl(ci,"nui://"..GetCurrentResourceName().."/"..bF,bG or 1920,bH or 1080)end;co.scale=function(self,X)w.Cache.N3d[ci].advanced_scale=X;s("Utility:Edit","N3d",ci,"advanced_scale",X)end;co.rotation=function(self,bt,cp)w.Cache.N3d[ci].rotation.rotation=bt;w.Cache.N3d[ci].rotation.syncedwithplayer=cp;s("Utility:Edit","N3d",ci,"rotation",{rotation=bt,syncedwithplayer=cp})end;co.destroy=function(self)if w.Cache.N3d[ci].dui~=nil then DestroyDui(w.Cache.N3d[ci].dui)SetScaleformMovieAsNoLongerNeeded(cm)s("Utility:Remove","N3d",ci)end end;co.started=function()return w.Cache.N3d[ci].dui~=nil end;co.show=function(self,P,X)w.Cache.N3d[ci].coords=P;w.Cache.N3d[ci].scale=X or 0.1;w.Cache.N3d[ci].show=true;s("Utility:Edit","N3d",ci,"coords",P)s("Utility:Edit","N3d",ci,"scale",X or 0.1)s("Utility:Edit","N3d",ci,"show",true)end;co.visible=function()return w.Cache.N3d[ci].show end;co.hide=function()w.Cache.N3d[ci].show=false;s("Utility:Edit","N3d",ci,"show",false)end;co.attach=function(self,ad,cq)w.Cache.N3d[ci].attach={entity=ad,offset=cq or vector3(0.0,0.0,0.0)}s("Utility:Edit","N3d",ci,"attach",{entity=ad,offset=cq or vector3(0.0,0.0,0.0)})end;co.detach=function(self,cr)if cr then w.Cache.N3d[ci].coords=GetEntityCoords(w.Cache.N3d[ci].attach.entity)s("Utility:Edit","N3d",ci,"coords",w.Cache.N3d[ci].coords)end;w.Cache.N3d[ci].attach=nil;s("Utility:Edit","N3d",ci,"attach",nil)end;co.object=function()return w.Cache.N3d[ci].dui end;co.msg=function(self,M)if self:started()then SendDuiMessage(self:object(),json.encode(M))end end;return setmetatable({},co)end;AddEventHandler("onResourceStop",function(cs)if cs==u then for au=1,#w.Cache.Events do RemoveEventHandler(w.Cache.Events[au])end;for ct,cu in pairs(w.Cache.N3d)do if cu.dui~=nil then DestroyDui(cu.dui)s("Utility:Remove","N3d",ct)end end;if w.Cache.Settings.UseDelete then for au=1,#w.Cache.EntityStack do local cv=w.Cache.EntityStack[au]NetworkRequestControlOfEntity(cv)if DoesEntityExist(cv)then DeleteEntity(cv)end end end end end)GetDirectionFromVectors=function(cw,cx)return cw-cx end;RotationToDirection=function(bt)local cy={x=math.pi/180*bt.x,y=math.pi/180*bt.y,z=math.pi/180*bt.z}local bi={x=-math.sin(cy.z)*math.abs(math.cos(cy.x)),y=math.cos(cy.z)*math.abs(math.cos(cy.x)),z=math.sin(cy.x)}return vector3(bi.x,bi.y,bi.z)end;TranslateZAnimated=function(ab,b2,cz)local P=GetEntityCoords(ab)local cA=b2<0;for au=1,math.abs(b2)*100 do local cB=cA and P.z-au/100 or P.z+au/100;SetEntityCoords(ab,P.x,P.y,cB)Citizen.Wait(cz)end end;SetVehicleWheelsPowered=function(af,ae)for au=0,GetVehicleNumberOfWheels(af)-1 do SetVehicleWheelIsPowered(af,au,ae)end end;CreateInteraction=function(ak,P,cC,bc,bd)developer("^2Created^0","Interaction",ak)exports["utility_interaction"]:CreateInteraction(ak,P,cC,bc,bd)end;DeleteInteraction=function(ak)developer("^1Deleted^0","Interaction",ak)exports["utility_interaction"]:DeleteInteraction(ak)end;ShowUtilityNotification=function(cD,cE,cF,cG,a9)exports["utility_notify"]:show(cD,cE,cF,cG,a9)end;CreateMissionText=function(M,a9)SetTextEntry_2("STRING")AddTextComponentString(M)DrawSubtitleTimed(a9 and math.floor(a9)or 60000*240,1)return{delete=function()ClearPrints()end}end;WaitNear=function(P)local b9=PlayerPedId()while#(GetEntityCoords(b9)-P)>10 do Citizen.Wait(100)end end;apairs=function(bQ,cH)local c8={}local au=0;for b5 in pairs(bQ)do table.insert(c8,b5)end;table.sort(c8,cH)local cI=function()au=au+1;if c8[au]==nil then return nil else return c8[au],bQ[c8[au]]end end;return cI end;FindInTable=function(table,W)for au=1,#table do if table[au]==W then return au end end;return nil end;GetRandom=function(table)local cJ=math.random(1,#table)return table[cJ]end;Probability=function(cK)return math.random()+math.random(0,99)<=cK end;AddPercentage=function(cK,cL)return cK+cK*cL/100 end;RemovePercentage=function(cK,cL)return cK-cK*cL/100 end;InTimeRange=function(cM,cN)local bB=nil;if utc then local a3,a3,a3,cO=GetUtcTime()bB=cO else bB=GetClockHours()end;if cN>cM then if bB>=cM and bB<=cN then return true end else if bB<=cN or bB>=cM then return false end end end